import java.io.FileWriter;
import java.io.IOException;
import java.util.ArrayList;
import java.util.Scanner;

class Produto {
    private String nome;
    private double preco;
    private int quantidade;
    private String observacoes;

    public Produto(String nome, double preco, int quantidade, String observacoes) {
        this.nome = nome;
        this.preco = preco;
        this.quantidade = quantidade;
        this.observacoes = observacoes;
    }

    @Override
    public String toString() {
        return "Produto{" +
                "nome='" + nome + '\'' +
                ", preco=" + preco +
                ", quantidade=" + quantidade +
                ", observacoes='" + observacoes + '\'' +
                '}';
    }

    public String toCSV() {
        return nome + "," + preco + "," + quantidade + "," + observacoes;
    }
}

public class CadastroDeProdutos {
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        // Etapa de cadastro de usuário
        System.out.println("Bem-vindo ao sistema! Antes de começar, cadastre-se.");
        System.out.print("Digite seu nome de usuário: ");
        String username = scanner.nextLine();
        System.out.print("Digite sua senha: ");
        String password = scanner.nextLine();
        System.out.println("Usuário cadastrado com sucesso!");

        // Menu de cadastro de produtos
        ArrayList<Produto> produtos = new ArrayList<>();
        System.out.println("\nBem-vindo ao sistema de cadastro de produtos!");

        while (true) {
            System.out.println("\n1. Cadastrar produto");
            System.out.println("2. Listar produtos");
            System.out.println("3. Salvar produtos em arquivo");
            System.out.println("4. Sair");
            System.out.print("Escolha uma opção: ");
            int opcao = scanner.nextInt();
            scanner.nextLine(); // Consumir a quebra de linha

            if (opcao == 1) {
                System.out.print("Digite o nome do produto: ");
                String nome = scanner.nextLine();

                System.out.print("Digite o preço do produto: ");
                double preco = scanner.nextDouble();

                System.out.print("Digite a quantidade do produto: ");
                int quantidade = scanner.nextInt();
                scanner.nextLine(); // Consumir a quebra de linha

                System.out.print("Digite observações sobre o produto: ");
                String observacoes = scanner.nextLine();

                Produto produto = new Produto(nome, preco, quantidade, observacoes);
                produtos.add(produto);

                System.out.println("Produto cadastrado com sucesso!");
            } else if (opcao == 2) {
                System.out.println("\nLista de produtos cadastrados:");
                for (Produto produto : produtos) {
                    System.out.println(produto);
                }
            } else if (opcao == 3) {
                salvarProdutosEmArquivo(produtos);
            } else if (opcao == 4) {
                System.out.println("Saindo do sistema. Até mais!");
                break;
            } else {
                System.out.println("Opção inválida. Tente novamente.");
            }
        }

        scanner.close();
    }

    private static void salvarProdutosEmArquivo(ArrayList<Produto> produtos) {
        try (FileWriter writer = new FileWriter("produtos.csv")) {
            writer.write("Nome,Preço,Quantidade,Observações\n"); // Cabeçalho do arquivo
            for (Produto produto : produtos) {
                writer.write(produto.toCSV() + "\n");
            }
            System.out.println("Produtos salvos com sucesso no arquivo 'produtos.csv'!");
        } catch (IOException e) {
            System.out.println("Erro ao salvar os produtos: " + e.getMessage());
        }
    }
}
